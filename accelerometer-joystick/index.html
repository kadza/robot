<!doctype html>
<html>

<head>
    <title>Robot joystick</title>
    <meta name="description" content="Robot joystick">
</head>
<script>
    const exampleSocket = new WebSocket("ws://localhost:8765");
    exampleSocket.onopen = () => {
        document.getElementById("connection-status").innerHTML = "Connected"
    };

    exampleSocket.onmessage = (event) => {
        console.log(event.data)
        document.getElementById("message-status").innerHTML = event.data
    }

    function sendMessage(message) {
        exampleSocket.send(JSON.stringify(message))
    }

    function requestPermissions() {
        DeviceMotionEvent.requestPermission()
            .then(response => {
                if (response == 'granted') {
                    window.addEventListener('devicemotion', (e) => {
                        document.getElementById("rot-z").innerHTML = e.rotationRate.alpha
                        document.getElementById("rot-x").innerHTML = e.rotationRate.beta
                        document.getElementById("rot-y").innerHTML = e.rotationRate.gamma
                    })
                }
            })
            .catch(console.error)
    }
</script>

<body>
    <button onclick="requestPermissions()">Start</button>
    <button onclick="sendMessage({direction: 'up', value: 1})">test</button>
    <p id="connection-status">Connecting ...</p>
    <p id="acc-x"></p>
    <p id="acc-y"></p>
    <p id="acc-z"></p>
    <p id="rot-x"></p>
    <p id="rot-y"></p>
    <p id="rot-z"></p>
</body>

</html>